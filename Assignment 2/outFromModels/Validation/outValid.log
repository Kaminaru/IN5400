predicted_tokens.shape torch.Size([64, 40])


Generated caption
a train traveling down tracks next to a train station


Original captions:
A long train sitting on a railroad track. 
A trainyard with several container cars on the tracks.
A long train filled with tanker cars on rail road tracks.
Many train compartments parked along the train tracks.
A long row of train carts sitting in a yard of tracks.




Generated caption
a man standing next to a man in a hat


Original captions:
A tourist unfolds an umbrella near ancient ruins.
Adults standing on carved stone display overlooking large city.
A man and woman that are standing next to rocks.
A couple of men holding a black umbrella.
Two men on old architecture pull out umbrella and securing their belongings.




Generated caption
a pizza sitting on top of a pizza pan on top of a table


Original captions:
A close up of a pizza pie sitting on a table.
A woman sitting at a table with two pizzas.
pizza missing one slice on wooden serving tray
a couple of pizzas are on a table
A pizza that is sitting on a wooden platter.




Generated caption
a man standing on a couch playing a video game


Original captions:
Two men play Wii in a cramped living room.
Two men standing in a living room with remotes.
Two men standing in a living room playing games.
Two men playing video games on the Nintendo Wii.
Two men standing in a living room holding game controllers.




Generated caption
a bathroom with a toilet and a urinal


Original captions:
Three white urinals mounted to a bathroom wall.
Three urinals each have small signs posted above them.
Three urinals are displayed with sings above them.
Urinals with signs hanging over them in a restroom.
A view of a bunch of urinals with stickers above them.


PTBTokenizer tokenized 256462 tokens at 411849.82 tokens per second.
PTBTokenizer tokenized 53839 tokens at 147415.80 tokens per second.
PTBTokenizer tokenized 256462 tokens at 291889.99 tokens per second.
PTBTokenizer tokenized 53839 tokens at 153579.32 tokens per second.
at iter 0
at iter 500
at iter 1000
at iter 1500
at iter 2000
at iter 2500
at iter 3000
at iter 3500
at iter 4000
at iter 4500
Calculating Evalaution Metric Scores......

{'testlen': 49648, 'reflen': 48614, 'guess': [49648, 44648, 39648, 34648], 'correct': [33012, 16313, 7474, 3585]}
ratio: 1.021269593121302
Evaluation results, BLEU-4: 0.26236818788977123, Cider: 0.8030467427093326,  ROUGE: 0.5096203554704348, Meteor: 0.24918231446874872
  0%|          | 0/79 [00:00<?, ?it/s]val | Epcohs=best | loss=2.6445:   0%|          | 0/79 [00:01<?, ?it/s]val | Epcohs=best | loss=2.6445:   1%|▏         | 1/79 [00:01<01:47,  1.37s/it]val | Epcohs=best | loss=2.5234:   3%|▎         | 2/79 [00:01<01:45,  1.37s/it]val | Epcohs=best | loss=2.5234:   4%|▍         | 3/79 [00:01<00:29,  2.57it/s]val | Epcohs=best | loss=2.5309:   5%|▌         | 4/79 [00:01<00:29,  2.57it/s]val | Epcohs=best | loss=2.5309:   6%|▋         | 5/79 [00:01<00:16,  4.44it/s]val | Epcohs=best | loss=2.5117:   6%|▋         | 5/79 [00:01<00:16,  4.44it/s]val | Epcohs=best | loss=2.5117:   8%|▊         | 6/79 [00:01<00:12,  5.89it/s]val | Epcohs=best | loss=2.2354:   9%|▉         | 7/79 [00:01<00:12,  5.89it/s]val | Epcohs=best | loss=2.2354:  10%|█         | 8/79 [00:01<00:07, 10.02it/s]val | Epcohs=best | loss=2.4684:  10%|█         | 8/79 [00:01<00:07, 10.02it/s]val | Epcohs=best | loss=2.4684:  11%|█▏        | 9/79 [00:01<00:05, 11.93it/s]val | Epcohs=best | loss=2.6808:  11%|█▏        | 9/79 [00:01<00:05, 11.93it/s]val | Epcohs=best | loss=2.6808:  13%|█▎        | 10/79 [00:01<00:04, 14.46it/s]val | Epcohs=best | loss=2.6039:  14%|█▍        | 11/79 [00:01<00:04, 14.46it/s]val | Epcohs=best | loss=2.6039:  15%|█▌        | 12/79 [00:01<00:02, 23.50it/s]val | Epcohs=best | loss=2.3034:  15%|█▌        | 12/79 [00:01<00:02, 23.50it/s]val | Epcohs=best | loss=2.3034:  16%|█▋        | 13/79 [00:01<00:03, 18.33it/s]val | Epcohs=best | loss=2.3451:  16%|█▋        | 13/79 [00:01<00:03, 18.33it/s]val | Epcohs=best | loss=2.3451:  18%|█▊        | 14/79 [00:01<00:03, 16.51it/s]val | Epcohs=best | loss=2.6278:  18%|█▊        | 14/79 [00:01<00:03, 16.51it/s]val | Epcohs=best | loss=2.6278:  19%|█▉        | 15/79 [00:01<00:03, 19.94it/s]val | Epcohs=best | loss=2.3681:  20%|██        | 16/79 [00:01<00:03, 19.94it/s]val | Epcohs=best | loss=2.4769:  22%|██▏       | 17/79 [00:01<00:03, 19.94it/s]val | Epcohs=best | loss=2.4769:  23%|██▎       | 18/79 [00:01<00:01, 37.55it/s]val | Epcohs=best | loss=2.4360:  23%|██▎       | 18/79 [00:01<00:01, 37.55it/s]val | Epcohs=best | loss=2.4360:  24%|██▍       | 19/79 [00:01<00:01, 38.87it/s]val | Epcohs=best | loss=2.6035:  24%|██▍       | 19/79 [00:01<00:01, 38.87it/s]val | Epcohs=best | loss=2.6035:  25%|██▌       | 20/79 [00:01<00:01, 32.38it/s]val | Epcohs=best | loss=2.5910:  25%|██▌       | 20/79 [00:02<00:01, 32.38it/s]val | Epcohs=best | loss=2.5910:  27%|██▋       | 21/79 [00:02<00:01, 37.59it/s]val | Epcohs=best | loss=2.5533:  28%|██▊       | 22/79 [00:02<00:01, 37.59it/s]val | Epcohs=best | loss=2.5533:  29%|██▉       | 23/79 [00:02<00:01, 51.56it/s]val | Epcohs=best | loss=2.4635:  29%|██▉       | 23/79 [00:02<00:01, 51.56it/s]val | Epcohs=best | loss=2.4635:  30%|███       | 24/79 [00:02<00:01, 46.40it/s]val | Epcohs=best | loss=2.5817:  30%|███       | 24/79 [00:02<00:01, 46.40it/s]val | Epcohs=best | loss=2.5817:  32%|███▏      | 25/79 [00:02<00:01, 38.91it/s]val | Epcohs=best | loss=2.6133:  32%|███▏      | 25/79 [00:02<00:01, 38.91it/s]val | Epcohs=best | loss=2.6133:  33%|███▎      | 26/79 [00:02<00:01, 45.37it/s]val | Epcohs=best | loss=2.2744:  33%|███▎      | 26/79 [00:02<00:01, 45.37it/s]val | Epcohs=best | loss=2.2744:  34%|███▍      | 27/79 [00:02<00:02, 23.74it/s]val | Epcohs=best | loss=2.4599:  34%|███▍      | 27/79 [00:02<00:02, 23.74it/s]val | Epcohs=best | loss=2.4599:  35%|███▌      | 28/79 [00:02<00:01, 27.92it/s]val | Epcohs=best | loss=2.4426:  37%|███▋      | 29/79 [00:02<00:01, 27.92it/s]val | Epcohs=best | loss=2.4426:  38%|███▊      | 30/79 [00:02<00:01, 41.89it/s]val | Epcohs=best | loss=2.4590:  38%|███▊      | 30/79 [00:02<00:01, 41.89it/s]val | Epcohs=best | loss=2.4590:  39%|███▉      | 31/79 [00:02<00:01, 47.37it/s]val | Epcohs=best | loss=2.7669:  39%|███▉      | 31/79 [00:02<00:01, 47.37it/s]val | Epcohs=best | loss=2.7669:  41%|████      | 32/79 [00:02<00:01, 36.69it/s]val | Epcohs=best | loss=2.6262:  41%|████      | 32/79 [00:02<00:01, 36.69it/s]val | Epcohs=best | loss=2.7689:  42%|████▏     | 33/79 [00:02<00:01, 36.69it/s]val | Epcohs=best | loss=2.7689:  43%|████▎     | 34/79 [00:02<00:00, 50.32it/s]val | Epcohs=best | loss=2.5582:  43%|████▎     | 34/79 [00:02<00:00, 50.32it/s]val | Epcohs=best | loss=2.5582:  44%|████▍     | 35/79 [00:02<00:00, 53.19it/s]val | Epcohs=best | loss=2.6824:  44%|████▍     | 35/79 [00:02<00:00, 53.19it/s]val | Epcohs=best | loss=2.6824:  46%|████▌     | 36/79 [00:02<00:00, 57.72it/s]val | Epcohs=best | loss=2.6346:  47%|████▋     | 37/79 [00:02<00:00, 57.72it/s]val | Epcohs=best | loss=2.6346:  48%|████▊     | 38/79 [00:02<00:00, 81.77it/s]val | Epcohs=best | loss=2.5607:  48%|████▊     | 38/79 [00:02<00:00, 81.77it/s]val | Epcohs=best | loss=2.5303:  49%|████▉     | 39/79 [00:02<00:00, 81.77it/s]val | Epcohs=best | loss=2.5303:  51%|█████     | 40/79 [00:02<00:00, 44.09it/s]val | Epcohs=best | loss=2.3971:  51%|█████     | 40/79 [00:02<00:00, 44.09it/s]val | Epcohs=best | loss=2.3971:  52%|█████▏    | 41/79 [00:02<00:00, 42.16it/s]val | Epcohs=best | loss=2.4216:  52%|█████▏    | 41/79 [00:02<00:00, 42.16it/s]val | Epcohs=best | loss=2.4216:  53%|█████▎    | 42/79 [00:02<00:01, 32.15it/s]val | Epcohs=best | loss=2.6778:  53%|█████▎    | 42/79 [00:02<00:01, 32.15it/s]val | Epcohs=best | loss=2.6778:  54%|█████▍    | 43/79 [00:02<00:00, 37.59it/s]val | Epcohs=best | loss=2.4279:  54%|█████▍    | 43/79 [00:02<00:00, 37.59it/s]val | Epcohs=best | loss=2.4279:  56%|█████▌    | 44/79 [00:02<00:01, 29.09it/s]val | Epcohs=best | loss=2.6512:  56%|█████▌    | 44/79 [00:02<00:01, 29.09it/s]val | Epcohs=best | loss=2.6512:  57%|█████▋    | 45/79 [00:02<00:00, 35.09it/s]val | Epcohs=best | loss=2.4927:  58%|█████▊    | 46/79 [00:02<00:00, 35.09it/s]val | Epcohs=best | loss=2.4927:  59%|█████▉    | 47/79 [00:02<00:00, 53.22it/s]val | Epcohs=best | loss=2.4351:  59%|█████▉    | 47/79 [00:02<00:00, 53.22it/s]val | Epcohs=best | loss=2.4351:  61%|██████    | 48/79 [00:02<00:00, 56.68it/s]val | Epcohs=best | loss=2.4219:  61%|██████    | 48/79 [00:02<00:00, 56.68it/s]val | Epcohs=best | loss=2.4219:  62%|██████▏   | 49/79 [00:02<00:00, 62.06it/s]val | Epcohs=best | loss=2.5933:  62%|██████▏   | 49/79 [00:02<00:00, 62.06it/s]val | Epcohs=best | loss=2.5933:  63%|██████▎   | 50/79 [00:02<00:01, 17.25it/s]val | Epcohs=best | loss=2.5833:  63%|██████▎   | 50/79 [00:02<00:01, 17.25it/s]val | Epcohs=best | loss=2.5833:  65%|██████▍   | 51/79 [00:02<00:01, 20.38it/s]val | Epcohs=best | loss=2.2822:  65%|██████▍   | 51/79 [00:02<00:01, 20.38it/s]val | Epcohs=best | loss=2.2822:  66%|██████▌   | 52/79 [00:02<00:01, 24.65it/s]val | Epcohs=best | loss=2.3548:  66%|██████▌   | 52/79 [00:02<00:01, 24.65it/s]val | Epcohs=best | loss=2.3548:  67%|██████▋   | 53/79 [00:02<00:00, 30.28it/s]val | Epcohs=best | loss=2.4697:  67%|██████▋   | 53/79 [00:02<00:00, 30.28it/s]val | Epcohs=best | loss=2.4161:  68%|██████▊   | 54/79 [00:02<00:00, 30.28it/s]val | Epcohs=best | loss=2.4161:  70%|██████▉   | 55/79 [00:02<00:00, 43.20it/s]val | Epcohs=best | loss=2.5065:  71%|███████   | 56/79 [00:02<00:00, 43.20it/s]val | Epcohs=best | loss=2.5065:  72%|███████▏  | 57/79 [00:02<00:00, 61.62it/s]val | Epcohs=best | loss=2.5838:  72%|███████▏  | 57/79 [00:02<00:00, 61.62it/s]val | Epcohs=best | loss=2.4813:  73%|███████▎  | 58/79 [00:02<00:00, 61.62it/s]val | Epcohs=best | loss=2.4813:  75%|███████▍  | 59/79 [00:02<00:00, 72.79it/s]val | Epcohs=best | loss=2.7318:  75%|███████▍  | 59/79 [00:02<00:00, 72.79it/s]val | Epcohs=best | loss=2.2488:  76%|███████▌  | 60/79 [00:03<00:00, 72.79it/s]val | Epcohs=best | loss=2.2488:  77%|███████▋  | 61/79 [00:03<00:00, 28.59it/s]val | Epcohs=best | loss=2.5260:  77%|███████▋  | 61/79 [00:03<00:00, 28.59it/s]val | Epcohs=best | loss=2.6125:  78%|███████▊  | 62/79 [00:03<00:00, 28.59it/s]val | Epcohs=best | loss=2.6125:  80%|███████▉  | 63/79 [00:03<00:00, 27.50it/s]val | Epcohs=best | loss=2.4852:  80%|███████▉  | 63/79 [00:03<00:00, 27.50it/s]val | Epcohs=best | loss=2.4852:  81%|████████  | 64/79 [00:03<00:00, 30.27it/s]val | Epcohs=best | loss=2.5656:  81%|████████  | 64/79 [00:03<00:00, 30.27it/s]val | Epcohs=best | loss=2.5656:  82%|████████▏ | 65/79 [00:03<00:00, 30.70it/s]val | Epcohs=best | loss=2.5374:  82%|████████▏ | 65/79 [00:03<00:00, 30.70it/s]val | Epcohs=best | loss=2.5374:  84%|████████▎ | 66/79 [00:03<00:00, 24.30it/s]val | Epcohs=best | loss=2.6257:  85%|████████▍ | 67/79 [00:03<00:00, 24.30it/s]val | Epcohs=best | loss=2.6257:  86%|████████▌ | 68/79 [00:03<00:00, 34.06it/s]val | Epcohs=best | loss=2.7125:  86%|████████▌ | 68/79 [00:03<00:00, 34.06it/s]val | Epcohs=best | loss=2.7125:  87%|████████▋ | 69/79 [00:03<00:00, 34.04it/s]val | Epcohs=best | loss=2.5685:  87%|████████▋ | 69/79 [00:03<00:00, 34.04it/s]val | Epcohs=best | loss=2.5685:  89%|████████▊ | 70/79 [00:03<00:00, 33.67it/s]val | Epcohs=best | loss=2.6045:  89%|████████▊ | 70/79 [00:03<00:00, 33.67it/s]val | Epcohs=best | loss=2.6045:  90%|████████▉ | 71/79 [00:03<00:00,  9.28it/s]val | Epcohs=best | loss=2.6228:  90%|████████▉ | 71/79 [00:03<00:00,  9.28it/s]val | Epcohs=best | loss=2.6228:  91%|█████████ | 72/79 [00:03<00:00, 12.18it/s]val | Epcohs=best | loss=2.3829:  91%|█████████ | 72/79 [00:03<00:00, 12.18it/s]val | Epcohs=best | loss=2.3829:  92%|█████████▏| 73/79 [00:03<00:00, 13.59it/s]val | Epcohs=best | loss=2.4323:  92%|█████████▏| 73/79 [00:03<00:00, 13.59it/s]val | Epcohs=best | loss=2.4323:  94%|█████████▎| 74/79 [00:03<00:00, 15.04it/s]val | Epcohs=best | loss=2.4850:  94%|█████████▎| 74/79 [00:03<00:00, 15.04it/s]val | Epcohs=best | loss=2.4850:  95%|█████████▍| 75/79 [00:03<00:00, 18.83it/s]val | Epcohs=best | loss=2.4876:  95%|█████████▍| 75/79 [00:03<00:00, 18.83it/s]val | Epcohs=best | loss=2.4876:  96%|█████████▌| 76/79 [00:03<00:00, 20.12it/s]val | Epcohs=best | loss=2.4078:  96%|█████████▌| 76/79 [00:03<00:00, 20.12it/s]val | Epcohs=best | loss=2.4078:  97%|█████████▋| 77/79 [00:03<00:00, 16.00it/s]val | Epcohs=best | loss=2.3671:  97%|█████████▋| 77/79 [00:03<00:00, 16.00it/s]val | Epcohs=best | loss=2.3671:  99%|█████████▊| 78/79 [00:03<00:00, 19.77it/s]val | Epcohs=best | loss=2.6795: 100%|██████████| 79/79 [00:03<00:00, 19.77it/s]val | Epcohs=best | loss=2.6795: : 80it [00:03, 30.78it/s]                      val | Epcohs=best | loss=2.5676: : 80it [00:04, 30.78it/s]val | Epcohs=best | loss=2.5676: : 81it [00:04, 36.94it/s]val | Epcohs=best | loss=2.4146: : 81it [00:04, 36.94it/s]val | Epcohs=best | loss=2.4146: : 82it [00:04, 42.49it/s]val | Epcohs=best | loss=2.6857: : 82it [00:04, 42.49it/s]val | Epcohs=best | loss=2.6857: : 83it [00:04, 26.80it/s]val | Epcohs=best | loss=2.6792: : 83it [00:04, 26.80it/s]val | Epcohs=best | loss=2.6792: : 84it [00:04, 33.05it/s]val | Epcohs=best | loss=2.4105: : 84it [00:04, 33.05it/s]val | Epcohs=best | loss=2.3187: : 85it [00:04, 33.05it/s]val | Epcohs=best | loss=2.3187: : 86it [00:04, 43.58it/s]val | Epcohs=best | loss=2.6459: : 86it [00:04, 43.58it/s]val | Epcohs=best | loss=2.6459: : 87it [00:04, 50.39it/s]val | Epcohs=best | loss=2.4928: : 87it [00:04, 50.39it/s]val | Epcohs=best | loss=2.6046: : 88it [00:04, 50.39it/s]val | Epcohs=best | loss=2.6046: : 89it [00:04, 58.99it/s]val | Epcohs=best | loss=2.6916: : 89it [00:04, 58.99it/s]val | Epcohs=best | loss=2.5129: : 90it [00:04, 58.99it/s]val | Epcohs=best | loss=2.5129: : 91it [00:04, 71.66it/s]val | Epcohs=best | loss=2.5129: 100%|██████████| 79/79 [00:04<00:00, 17.30it/s]
Best epoch loss: 2.522256849000056
